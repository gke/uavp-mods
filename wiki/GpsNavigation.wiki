Navigation has been implemented using the 18F2620 PIC which has significantly more memory available to it. This was one of the reasons that Wolferl was not able to implement navigation for the 16F876 version of equipped quadrocopter. 

For maximum flexibility we have chosen to implement the GPS interface using NMEA sentences. A reference to NMEA is at:

  http://home.mira.net/~gnb/gps/nmea.html

We use the $GPGGA sentence and optionally $RMC and $GSV.

Your GPS should preferably have the ability to update at 5Hz. Lower update rates will work but not as well. The ETEK and LocoSys GPS units have been used with success.

You require the compass and barometer. The Bosch SMD085 is the recommended barometer. 

See the hardware specific pages for details.

== Functionality ==

Navigation uses the Gear (Ch5) and Ch7 inputs. This means that parameters can no longer be changed in flight using Ch5, and roll trim for any servo driven camera is no longer available. Signals for roll and trim stabilisation are still generated. Ch6 is still available for camera pitch trim.

The implementation provides two principal functions:

* Position Hold: The current position is maintained while neither the pitch nor the roll stick are moved. When either is moved away from the neutral position a new potential hold point is recorded from the GPS.   Ch7 controls the overall sensitivity of position acquisition and hold. Navigation system may be disabled by turning the Ch7 Tx potentiometer to minimum sensitivity. The GPS derived altitude is not used for position hold.  

* Return to Home (RTH): If the Gear switch (Ch5) is activated the quadrocopter will attempt to return to the launch point, or more specifically, the position at which a reliable GPS signal was first acquired prior to launch.

Normally the altitude is controlled directly by the pilot with the assistance of the barometer.  RTH can optionally use the GPS altitude to return at some desired relative altitude.  

GPS acquisition is signalled by a solid Blue LED. This may take a few minutes to occur depending on the update rate of your GPS as UAVX requires around 100 valid GPS sentences with a small position error bound.

== UAVPset Parameters == 

Several of the navigation parameters are available through the UAVX version of UAVPset.  

The parameters are:

* Radius: The closing radius in Metres around the desired GPS position. Outside this radius maximum corrective control is applied. Inside the radius proportionately less control is exerted.

* Magnetic Variation: The number of degrees Magnetic North is East of True North for your location.

* Wind Compensation: Increases the amount of compensation if the desired position is not being maintained.

* RTH GPS Altitiude: If selected, the GPS altitude in Metres relative to the launch point to be maintained. There is no pilot throttle control with this function.  

* RTH Altitude Proportional & Integral: PID constants for altitude hold.

There are, of course, many other tuning parameters within the code which have not been brought through the UAVPSet interface!

The UAVX version of UAVPSet can read older parameter files and write them to the UAVX software on the quadrocopter. Parameters read from UAVX are not compatible with the original UAVP flight software.

== Stick Based Configuration ==

Parameter switching and enabling RTH GPS altitude hold is achieved using the pitch stick while the quadrocopter is disarmed. The corners are used with left being parameter set 1 and right 2. If the bottom corners are used RTH GPS altitude is enabled.  You should hear short beeps for the parameter set chosen followed by a slightly longer beep if RTH altitude hold is enabled.  

== PC/GPS Switching ==

The arming switch needs to be replaced by a double switch, which when arming, disconnects the PC Tx signal to the quadrocopter and connects the GPS Tx signal. When armed the UAVX software expects only valid GPS NMEA sentences. Specific details will appear under hardware related pages.

== Way Points == 

Way point navigation has not been implemented.

== GNU Conditions ==

The GNU conditions apply to this software which may be used entirely at your own risk.

Leave a comment if you have suggestions or can help out.